nickhuemmer@Nicks-Mac-mini reactime % npm run test

> test
> jest --verbose --coverage

 PASS  src/backend/__tests__/masterState.test.ts (6.145 s)
  Master State unit tests
    componentActionRecord unit tests
      clear
        ✓ should clear componentActionsRecord (1 ms)
      saveNew
        ✓ should add a new component to componentActionRecord and return its index (1 ms)
      getComponentByIndex
        ✓ should return the component at the specified index
        ✓ should return undefined when passed an index that does not exist
      getComponentByIndexHooks
        ✓ should return the components at the specified indices (1 ms)
        ✓ should return undefined when passed an empty array (1 ms)
        ✓ should return undefined when passed an index that does not exist
      getAllComponents
        ✓ should return all components in componentActionRecord (1 ms)

 FAIL  src/backend/__tests__/routes.test.ts
  ● Test suite failed to run

    ReferenceError: TextEncoder is not defined

    > 1 | import { JSDOM } from 'jsdom';
        | ^
      2 |
      3 | import { Routes, Route } from '../models/routes';
      4 |

      at Object.<anonymous> (node_modules/whatwg-url/lib/encoding.js:3:21)
      at Object.<anonymous> (node_modules/whatwg-url/lib/url-state-machine.js:7:5)
      at Object.<anonymous> (node_modules/whatwg-url/lib/URL-impl.js:3:13)
      at Object.<anonymous> (node_modules/whatwg-url/lib/URL.js:372:14)
      at Object.<anonymous> (node_modules/whatwg-url/webidl2js-wrapper.js:3:13)
      at Object.<anonymous> (node_modules/whatwg-url/index.js:6:5)
      at Object.<anonymous> (node_modules/jsdom/lib/api.js:8:19)
      at Object.<anonymous> (src/backend/__tests__/routes.test.ts:1:1)

[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.
[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.
[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.
[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.
[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.
[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.
 PASS  src/backend/__tests__/masterTree.test.tsx (7.83 s)
  master tree tests
    createTree Unit test
      Filter components that are from NextJS, Remix or not from allowed component types
        ✓ should return a Tree if we pass in a empty fiber node (1 ms)
        ✓ should filter out NextJS default components with no children or siblings (2 ms)
        ✓ should filter out remix default components with no children or siblings (2 ms)
        ✓ should only traverse allowed components (3 ms)
        ✓ should filter out NextJS & Remix default components with children and/or siblings (71 ms)
      Display component props information
        ✓ should display functional props information
        ✓ should display class props information (1 ms)
        ✓ should display React router props information (3 ms)
        ✓ should exclude reserved props name (14 ms)
        ✓ should skip circular props (4 ms)
        ✓ should display props information of multiple components (1 ms)
      Display component states information
        ✓ should display stateless if functional state empty
        ✓ should display class state information
        ✓ should keep track of class state index
        ✓ should display stateless if functional state empty
        ✓ should display functional state information (2 ms)
        ✓ should keep track of functional state index (1 ms)
      Replace fromLinkFiber class value
        ○ skipped NEED UNDERSTANDING THE PURPOSE OF FROMLINKFIBER FOR FRONTEND, currently unable to replicate DOMTokenList instance
    Tree unit test
      Serialize state unit test
        ✓ should create a deep copy of state
        ✓ should detect circular state
      Constructing a default tree
        ✓ should be able to create a newTree
        ✓ should have 6 properties (1 ms)
        ✓ should have default name, componentData, isExpanded and rtid
        ✓ should have no children
      Constructing a tree root
        ✓ should have name as 'root' and state as 'root'
      Adding children
        ✓ should return a new tree child (1 ms)
        ✓ should have the child be in the children's array property
        ✓ should have unique name
        ○ skipped should be able to add multiple children and sibilings
    createComponentActionsRecord unit test
      ✓ should save a new component action record if the Fiber node is a stateful class component (1 ms)
      ✓ should save a new component action record if the Fiber node is a stateful class component with props
      ✓ should save a new component action record if the Fiber node is a functional component with state
      ✓ should return the correct hooks array for a given component index
      ✓ should not save a new component action record if the Fiber node is not a relevant component type

 FAIL  src/backend/__tests__/linkFiber.test.ts
  ● Test suite failed to run

    ReferenceError: TextEncoder is not defined

      16 | import Tree from '../models/tree';
      17 | import { DevTools } from '../types/linkFiberTypes';
    > 18 | import { JSDOM } from 'jsdom';
         | ^
      19 | import path from 'path';
      20 | import fs from 'fs';
      21 |

      at Object.<anonymous> (node_modules/whatwg-url/lib/encoding.js:3:21)
      at Object.<anonymous> (node_modules/whatwg-url/lib/url-state-machine.js:7:5)
      at Object.<anonymous> (node_modules/whatwg-url/lib/URL-impl.js:3:13)
      at Object.<anonymous> (node_modules/whatwg-url/lib/URL.js:372:14)
      at Object.<anonymous> (node_modules/whatwg-url/webidl2js-wrapper.js:3:13)
      at Object.<anonymous> (node_modules/whatwg-url/index.js:6:5)
      at Object.<anonymous> (node_modules/jsdom/lib/api.js:8:19)
      at Object.<anonymous> (src/backend/__tests__/linkFiber.test.ts:18:1)

 PASS  src/backend/__tests__/throttle.test.ts
  throttle unit tests
    ✓ should return a function (3 ms)
    ✓ throttled function should be called with the correct arguments (2 ms)
    ✓ should invoke the callback immediately on the first call
    ✓ should invoke the callback only once if called multiple times within the throttling interval (1 ms)
    ✓ should invoke the callback multiple times if called outside of the throttling interval (1 ms)

 PASS  src/app/__tests__/ErrorMsg.test.tsx (7.098 s)
  unit testing for ErrorContainer.tsx
    When there are no errors
      ✓ Returns empty div (19 ms)
    when there's a RDT Error
      ✓ RDT error related text shows (14 ms)
    when there's a Content Script Errorr
      ✓ Content Script Error related text shows (8 ms)
      ✓ launch button shows (55 ms)
    when there's a Not React Error
      ✓ Not React App text shows (2 ms)

 PASS  src/app/__tests__/TravelContainer.test.tsx (13.599 s)
  All elements appear in the TravelContainer module
    ✓ first button contains text Play (71 ms)
    ✓ MainSlider exists in document (5 ms)
    ✓ Dropdown exists in document (5 ms)
    ✓ Backward button exists in document (43 ms)
    ✓ Foward button exists in document (21 ms)
  Testing backward and forward button
    ✓ Clicking < Button button will triger button (7 ms)
    ✓ Clicking > Button button will triger button (5 ms)
  Testing play/pause button
    ✓ Play button is rendered (1 ms)
    ✓ Play initially says Play (2 ms)
    ✓ Clicking Play button will triger button (1 ms)
    ✓ Play says Pause when `Playing` is set to False (1 ms)
    ✓ Clicking Pause button will trigger button (1 ms)

[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/lodash/lodash.js as it exceeds the max of 500KB.
[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/@fortawesome/free-solid-svg-icons/index.js as it exceeds the max of 500KB.
 PASS  src/app/__tests__/action.test.tsx (7.052 s)
  unit testing for Action.tsx
    When a component is shown on the page
      ✓ Action snapshot should be shown as Snapshot: 3.0 (96 ms)
      ✓ two buttons with time and Current when not at current snapshot (56 ms)
      ✓ Action snapshot should be shown as Snapshot: 3.0 (6 ms)
      ✓ when there's no have no duration data (13 ms)

[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/@fortawesome/free-solid-svg-icons/index.js as it exceeds the max of 500KB.
 PASS  src/app/__tests__/WebMetrics.test.tsx
  WebMetrics graph testing
    ✓ should have 1 div with class name "metric"  (19 ms)

 PASS  src/app/__tests__/ActionContainer.test.tsx (14.611 s)
  unit testing for ActionContainer
    ✓ Expect top arrow to be rendered (94 ms)
    ✓ Expect RouteDescription to be rendered (16 ms)
    ✓ Expect SwitchApp to be rendered (4 ms)
    ✓ Click works on clear button (24 ms)

 PASS  src/app/__tests__/ButtonContainer.test.tsx (15.225 s)
  Unit testing for ButtonContainer
    When button container is loaded
      ✓ should have 4 buttons  (140 ms)
    When view is unlock
      ✓ Button should show as unlocked (22 ms)
    Upload/Download
      ✓ Clicking upload and download buttons (49 ms)

 PASS  src/app/__tests__/Loader.test.tsx
  unit testing for Loader.tsx
    ✓ renders a loading icon (20 ms)
    ✓ renders a fail icon (25 ms)
    ✓ renders a check icon (1 ms)

 PASS  src/app/__tests__/ErrorContainer.test.tsx (15.455 s)
  unit testing for ErrorContainer.tsx
    ✓ logo image renders as expected (46 ms)
    ✓ ErrorMsg component renders as expected (6 ms)
    ✓ Reactime website shows as expected (5 ms)
    Loading Checks show up as expected
      ✓ Content script launching check shows (3 ms)
      ✓ React Dev Tool Install check shows (3 ms)
      ✓ Compatible app check shows (3 ms)
    Launching header shows correct tab info
      ✓ When currentTitle has no target (2 ms)
      ✓ When currentTitle has a target title (3 ms)

 PASS  src/app/__tests__/Tutorial.test.tsx (7.317 s)
  Before Tutorial is entered
    ✓ How to use button exists (26 ms)
    ✓ User clicking "How to use" while on map tab button starts map tutorial  (55 ms)
    ✓ User clicking "How to use" while on performance tab button starts performance tutorial  (20 ms)
    ✓ User clicking "How to use" while on performance comparison tab, no tutorial available  (15 ms)

 PASS  src/app/__tests__/dropdown.test.tsx
  Dropdown test
    ✓ renders Dropdown with correct info (36 ms)

[BABEL] Note: The code generator has deoptimised the styling of /Users/nickhuemmer/projects/reactime/node_modules/@sinonjs/text-encoding/lib/encoding-indexes.js as it exceeds the max of 500KB.
 PASS  src/app/__tests__/MainSlider.test.tsx (9.551 s)
  Unit testing for MainSlider.jsx
    When user only has one snapshot to view
      ✓ Component should have min, max, value with correct values to indicate slider position for correct tab (42 ms)
    When there are multiple snapshots and we are looking in between
      ✓ Component should have min, max, value with correct values to indicate slider position when there are multiple snapshots (8 ms)

 PASS  src/app/__tests__/MainContainer.test.tsx (20.125 s)
  With no snapshots, should not render any containers
    ✓ With no snapshots, ErrorContainer should render (17 ms)
    ✓ With no snapshots, ActionContainer should not render (2 ms)
    ✓ With no snapshots, StateContainer should not render (2 ms)
    ✓ With no snapshots, TravelContainer should not render (1 ms)
    ✓ With no snapshots, ButtonsContainer should not render (2 ms)
  With snapshots, should render all containers
    ✓ With snapshots, ErrorContainer should not render (1 ms)
    ✓ With snapshots, ActionContainer should not render (4 ms)
    ✓ With snapshots, StateContainer should render (2 ms)
    ✓ With snapshots, TravelContainer should render (2 ms)
    ✓ With snapshots, ButtonsContainer should render (1 ms)

----------------------------------|---------|----------|---------|---------|----------------------------------------
File                              | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                      
----------------------------------|---------|----------|---------|---------|----------------------------------------
All files                         |    78.5 |    56.71 |   65.87 |   78.63 |                                        
 app                              |      80 |      100 |       0 |     100 |                                        
  store.tsx                       |      80 |      100 |       0 |     100 |                                        
 app/actions                      |   75.94 |      100 |   26.92 |     100 |                                        
  actions.ts                      |   75.94 |      100 |   26.92 |     100 |                                        
 app/components                   |   82.65 |    72.58 |   81.48 |   80.79 |                                        
  Action.tsx                      |   65.62 |    61.11 |      40 |   65.62 | 51-56,66,82-118                        
  Dropdown.tsx                    |     100 |      100 |     100 |     100 |                                        
  ErrorMsg.tsx                    |   95.65 |    88.88 |     100 |     100 | 11                                     
  Loader.tsx                      |     100 |      100 |     100 |     100 |                                        
  MainSlider.tsx                  |    86.2 |       50 |      60 |   81.81 | 35,47-51                               
  Tutorial.tsx                    |   74.54 |    70.37 |     100 |   72.54 | 40-41,44,47-48,51-52,55,227-316        
  WebMetrics.tsx                  |     100 |      100 |     100 |     100 |                                        
 app/constants                    |     100 |      100 |     100 |     100 |                                        
  actionTypes.ts                  |     100 |      100 |     100 |     100 |                                        
 app/containers                   |   67.14 |    38.55 |   61.53 |   62.66 |                                        
  ActionContainer.tsx             |   75.32 |       56 |   72.72 |   72.13 | 16,63-80,121,126-131                   
  ButtonsContainer.tsx            |   75.67 |       40 |    62.5 |   71.87 | 38-47,64                               
  ErrorContainer.tsx              |   61.36 |    30.76 |      50 |    57.5 | 17,27,33-37,43-49,56-60,63,66          
  MainContainer.tsx               |   52.38 |    21.42 |    37.5 |   47.94 | 26-35,49-85,90,121,124,127,130,133-138 
  TravelContainer.tsx             |   82.85 |    57.14 |   83.33 |   77.77 | 39-40,43-47                            
 backend/controllers              |   86.33 |    57.44 |     100 |   88.59 |                                        
  createComponentActionsRecord.ts |   81.48 |     70.9 |     100 |    91.3 | 64,96                                  
  createTree.ts                   |   77.27 |    56.25 |     100 |    75.8 | 135-145,260-273                        
  statePropExtractors.ts          |   95.65 |    51.14 |     100 |     100 | 105-107,117-123,128-137                
  throttle.ts                     |     100 |      100 |     100 |     100 |                                        
 backend/models                   |   81.44 |    72.22 |      85 |   80.89 |                                        
  filterConditions.ts             |     100 |      100 |     100 |     100 |                                        
  masterState.ts                  |     100 |      100 |     100 |     100 |                                        
  routes.ts                       |   58.13 |    16.66 |   57.14 |   56.41 | 54,66,76-84,99-117                     
  tree.ts                         |     100 |      100 |     100 |     100 |                                        
 backend/types                    |     100 |      100 |     100 |     100 |                                        
  backendTypes.ts                 |     100 |      100 |     100 |     100 |                                        
----------------------------------|---------|----------|---------|---------|----------------------------------------
Test Suites: 2 failed, 15 passed, 17 total
Tests:       2 skipped, 102 passed, 104 total
Snapshots:   0 total
Time:        20.897 s
Ran all test suites.